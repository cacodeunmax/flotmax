library(ggplot2)
library(dplyr)


folder_path_simu="simulations/simulations_auto/"
file_path <- file.path(folder_path_simu, "simulation_results_edmondVS.csv")
res=read.csv(file_path)
str(res)
# res$ccp=factor(res)

colnames(res)=c("E","flowmax","V","ExecutionTime","ccp")

table=res%>%filter(V==102)
dim(table)

table$ccp <- factor(table$ccp,levels = c(0,1),labels=c("R","Rcpp"))

# Créer le graphique de points avec des couleurs de remplissage différentes pour ccp
p=ggplot(table, aes(x = E, y = ExecutionTime, fill = ccp)) +
  geom_point(shape = 21, color = "black") +
  labs(x = "E", y = "Execution Time", title = "Edmond-Karps R vs Rcpp",subtitle = "V = 102, 620 obs") +
  scale_fill_manual(values = c("blue", "red"), labels = c("R", "Rcpp"))




folder_path_exploitation <- "simulations/exploitation_simu/"
ggsave(file.path(folder_path_exploitation, "edmondvs_v102.png"), plot = p, width = 10, height = 8, dpi = 300)



#######################


file_path <- file.path(folder_path_simu, "simulation_results_edmondVS_Efixe.csv")
res=read.csv(file_path)

colnames(res)=c("E","flowmax","V","ExecutionTime","ccp")

table=res%>%filter(E>=3000-30)%>%filter(E<=3000+30)
dim(table)

sub=paste("E environ 3000 (10%), nb obs",dim(table)[1],sep=" ")

table$ccp <- factor(table$ccp,levels = c(0,1),labels=c("R","Rcpp"))

# Créer le graphique de points avec des couleurs de remplissage différentes pour ccp
p=ggplot(table, aes(x = V, y = ExecutionTime, fill = ccp)) +
  geom_point(shape = 21, color = "black") +
  labs(x = "V", y = "Execution Time", title = "Edmond-Karps R vs Rcpp",subtitle = sub) +
  scale_fill_manual(values = c("blue", "red"), labels = c("R", "Rcpp"))
p


ggsave(file.path(folder_path_exploitation, "edmondvs_E300.png"), plot = p, width = 10, height = 8, dpi = 300)




plog=ggplot(table, aes(x = log(V), y = ExecutionTime, fill = ccp)) +
  geom_point(shape = 21, color = "black") +
  labs(x = "log(V)", y = "Execution Time", title = "Edmond-Karps R vs Rcpp",subtitle = sub) +
  scale_fill_manual(values = c("blue", "red"), labels = c("R", "Rcpp"))
plog




ggsave(file.path(folder_path_exploitation, "edmondvs_E300_log.png"), plot = plog, width = 10, height = 8, dpi = 300)


